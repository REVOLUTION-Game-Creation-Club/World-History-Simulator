{
  "decisions": [
    {
      "id": "tribe_decide_fostering_relationship",
      "name": "tribe decide fostering relationship",
      "target": "faction",
      "parameters": [
        { "id": "contact_polity", "type": "polity" },
        { "id": "chance_of_making_attempt", "type": "number" }
      ],
      "properties": [
        { "id": "target_polity", "value": "target.polity" },
        { "id": "target_isolation", "value": "target.preferences.isolation" }
      ],
      "description": [
        {
          "id": "description_intro",
          "text": "The clan's tribal elders suggest that the relationship between the dominant factions of <<contact_polity>> and <<target_polity>> could be improved.\n\nShould <<target.leader>> make an attempt to improve the relationship with <<contact_polity>>?"
        }
      ],
      "options": [
        {
          "id": "make_attempt",
          "text": "Attempt to improve relationship with <<contact_polity>>...",
          "weight": "max(0, chance_of_making_attempt)",
          "effects": [
            {
              "id": "decrease_isolation",
              "properties": [
                { "id": "charisma_factor", "value": "1.5 - target.leader.charisma" },
                { "id": "isolation_min", "value": "lerp(target_isolation, 0, (0.2 * charisma_factor))" },
                { "id": "isolation_max", "value": "lerp(target_isolation, 0, (0.1 * charisma_factor))" }
              ],
              "text": "<<target>>: isolation preference (<<target_isolation>>) decreases to: <<isolation_min>> - <<isolation_max>>",
              "result": "target.preferences.isolation = random(isolation_min, isolation_max)"
            },
            {
              "id": "attempt",
              "text": "The current leader of <<contact_polity>> will receive an offer from tribe <<target_polity>>",
              "result": "contact_polity.dominant_faction.trigger_decision(tribe_decide_accept_foster_relationship_attempt, target_polity)"
            }
          ]
        },
        {
          "id": "dont_make_attempt",
          "text": "Don't waste time trying to foster relationships...",
          "weight": "1 - min(1, chance_of_making_attempt)",
          "effects": [
            {
              "id": "increase_isolation",
              "properties": [
                { "id": "charisma_factor", "value": "0.5 + target.leader.charisma" },
                { "id": "isolation_min", "value": "lerp(target_isolation, 1, (0.1 * charisma_factor))" },
                { "id": "isolation_max", "value": "lerp(target_isolation, 1, (0.2 * charisma_factor))" }
              ],
              "text": "<<target>>: isolation preference (<<target_isolation>>) increases to: <<isolation_min>> - <<isolation_max>>",
              "result": "target.preferences.isolation = random(isolation_min, isolation_max)"
            }
          ]
        }
      ]
    },
    {
      "id": "relationship_foster_attempted",
      "name": "relationship foster attempted",
      "target": "faction",
      "parameters": [
        { "id": "attempting_polity", "type": "polity" }
      ],
      "properties": [
        { "id": "target_polity", "value": "target.polity" },
        { "id": "attempting_faction", "value": "attempting_polity.dominant_faction" },
        { "id": "relationship_value", "value": "target.relationship(attempting_faction)" },
        { "id": "target_isolation", "value": "target.preferences.isolation" },
        { "id": "contact_strength", "value": "target_polity.calculate_contact_strength(attempting_polity)" },
        { "id": "chance_of_rejecting_attempt", "value": "(1 - relationship_value) * (contact_strength * 3) * (1 - target_isolation)" }
      ],
      "description": [
        {
          "id": "description_intro",
          "text": "<<attempting_polity.leader>>, leader of <<attempting_polity>>, is attempting to improve the relationship between our tribes\n\nShould <<target.leader>> foster the relationship with <<attempting_polity>>?"
        }
      ],
      "options": [
        {
          "id": "reject_attempt",
          "text": "Reject attempt from <<attempting_polity>>...",
          "weight": "max(0, chance_of_rejecting_attempt)",
          "effects": [
            {
              "id": "increase_isolation",
              "properties": [
                { "id": "charisma_factor", "value": "0.5 + target.leader.charisma" },
                { "id": "isolation_min", "value": "lerp(target_isolation, 1, (0.1 * charisma_factor))" },
                { "id": "isolation_max", "value": "lerp(target_isolation, 1, (0.2 * charisma_factor))" }
              ],
              "text": "<<target>>: isolation preference (<<target_isolation>>) increases to: <<isolation_min>> - <<isolation_max>>",
              "result": "target.preferences.isolation = random(isolation_min, isolation_max)"
            },
            {
              "id": "decrease_relation",
              "properties": [
                { "id": "charisma_factor", "value": "1.5 - target.leader.charisma" },
                { "id": "relationship_min", "value": "lerp(relationship_value, 0, (0.2 * charisma_factor))" },
                { "id": "relationship_max", "value": "lerp(relationship_value, 0, (0.1 * charisma_factor))" }
              ],
              "text": "<<target>>: relationship with <<attempting_faction>>, dominant faction of <<attempting_polity>>, decreases from <<relationship_value>> to: <<relationship_min>> - <<relationship_max>>",
              "result": "target.set_relationship(attempting_faction, random(relationship_min, relationship_max))"
            }
          ]
        },
        {
          "id": "foster_relationship",
          "text": "Foster relationship with <<attempting_polity>>...",
          "weight": "1 - min(1, chance_of_rejecting_attempt)",
          "effects": [
            {
              "id": "decrease_isolation",
              "properties": [
                { "id": "charisma_factor", "value": "1.5 - target.leader.charisma" },
                { "id": "isolation_min", "value": "lerp(target_isolation, 0, (0.2 * charisma_factor))" },
                { "id": "isolation_max", "value": "lerp(target_isolation, 0, (0.1 * charisma_factor))" }
              ],
              "text": "<<target>>: isolation preference (<<target_isolation>>) decreases to: <<isolation_min>> - <<isolation_max>>",
              "result": "target.preferences.isolation = random(isolation_min, isolation_max)"
            },
            {
              "id": "increase_relation",
              "properties": [
                { "id": "charisma_factor", "value": "0.5 + target.leader.charisma" },
                { "id": "relationship_value", "value": "target.relationship(demanding_faction)" },
                { "id": "relationship_min", "value": "lerp(relationship_value, 1, (0.1 * charisma_factor))" },
                { "id": "relationship_max", "value": "lerp(relationship_value, 1, (0.2 * charisma_factor))" }
              ],
              "text": "<<target>>: relationship with <<attempting_faction>>, dominant faction of <<attempting_polity>>, increases from <<relationship_value>> to: <<relationship_min>> - <<relationship_max>>",
              "result": "target.set_relationship(attempting_faction, random(relationship_min, relationship_max))"
            }
          ]
        }
      ]
    }
  ]
}
